jQuery(document).ready(function(e){IWAjax.openPanels={},IWAjax.ajaxSemaphore=!1;var t=function(t){t.find(".inside").each(function(){var t=e(this).prop("id");IWAjax.openPanels[t]=e(this).parent(".postbox").hasClass("closed")?0:1})},i=function(t,i,s){if("undefined"!=typeof i.responseText&&i.responseText.match(/intelliwidget/))for(var a in IWAjax.openPanels)IWAjax.openPanels.hasOwnProperty(a)&&1==IWAjax.openPanels[a]&&(e("#"+a).parent(".postbox").removeClass("closed"),e("#"+a).show())},s=function(){e(".iw-tabbed-sections").each(function(){var t=e(this);t.data("viewWidth",0),t.data("visWidth",0),t.data("leftTabs",[]),t.data("rightTabs",[]),t.data("visTabs",[]),t.find(".iw-tab").each(function(){t.data("visTabs").push(e(this).prop("id")),t.data("visWidth",t.data("visWidth")+e(this).outerWidth()),e(this).show()})}),a()},a=function(){e(".iw-tabbed-sections").each(function(){var t=e(this);if(t.data("viewWidth",t.find(".iw-tabs").width()-24),t.data("viewWidth")>0)for(count=0;t.data("visTabs").length&&t.data("visWidth")>t.data("viewWidth");){var i=t.data("visTabs").shift(),s=e("#"+i).outerWidth();if(t.data("visWidth",t.data("visWidth")-s),e("#"+i).hide(),t.data("leftTabs").push(i),++count>50)break}}),o()},n=function(t){var i,s=t.parent(".iw-tabbed-sections");(i=s.data("visTabs").pop())&&(s.data("visWidth",s.data("visWidth")-e("#"+i).outerWidth()),e("#"+i).hide(),s.data("rightTabs").unshift(i)),(i=s.data("leftTabs").pop())&&(s.data("visWidth",s.data("visWidth")+e("#"+i).outerWidth()),e("#"+i).show(),s.data("visTabs").unshift(i)),o()},l=function(t){var i,s=t.parent(".iw-tabbed-sections");(i=s.data("visTabs").shift())&&(s.data("visWidth",s.data("visWidth")-e("#"+i).outerWidth()),e("#"+i).hide(),s.data("leftTabs").push(i)),(i=s.data("rightTabs").shift())&&(s.data("visWidth",s.data("visWidth")+e("#"+i).outerWidth()),e("#"+i).show(),s.data("visTabs").push(i)),o()},o=function(){e(".iw-larr, .iw-rarr").css("visibility","hidden"),e(".iw-tabbed-sections").each(function(){var t=e(this);t.data("rightTabs").length&&t.find(".iw-rarr").css("visibility","visible"),t.data("leftTabs").length&&t.find(".iw-larr").css("visibility","visible")})},r=function(t){e(t).find(".postbox .hndle, .handlediv").on("click",function(t){var i=e(this).parent(".postbox"),s=i.attr("id");i.toggleClass("closed"),s&&(!i.hasClass("closed")&&e.isFunction(postboxes.pbshow)?postboxes.pbshow(s):i.hasClass("closed")&&e.isFunction(postboxes.pbhide)&&postboxes.pbhide(s))})},d=function(){e(this).prop("disabled",!0),e(".iw-copy-container,.iw-save-container,.iw-cdf-container").removeClass("success failure"),e("body").off("click","#iw_cdfsave",d),e("#intelliwidget_cpt_spinner").show();var t={};return e("input[name=post_ID],input[name=iwpage],.intelliwidget-input").each(function(i,s){fieldID=e(this).attr("id"),t[fieldID]=e(this).val()}),t.action="iw_"+IWAjax.objtype+"_cdfsave",e.post(IWAjax.ajaxurl,t,function(t){return e("#iw_cdfsave").prop("disabled",!1),e("#intelliwidget_cpt_spinner").hide(),e(".iw-cdf-container").addClass("success"),!1}).fail(function(){return e("#iw_cdfsave").prop("disabled",!1),e("#intelliwidget_cpt_spinner").hide(),e(".iw-cdf-container").addClass("failure"),!1}),!1},c=function(e){var t=e.split("_"),i=t.pop(),s=t.pop();return s+"_"+i},p=function(){if(!0===IWAjax.ajaxSemaphore)return!1;IWAjax.ajaxSemaphore=!0,e(".iw-copy-container,.iw-save-container,.iw-cdf-container").removeClass("success failure");var i=e(this).parents(".iw-tabbed-section").first(),s=i.parent(".iw-tabbed-sections");return thisID=i.attr("id"),savecontainer=i.find(".iw-save-container"),savebutton=i.find(".iw-save"),pre=c(thisID),postData={},e(savebutton).prop("disabled",!0),t(i),e(".intelliwidget_"+pre+"_spinner").show(),e("body").off("click",savebutton,p),postData["intelliwidget_"+pre+"_post_types"]=[],postData.iwpage=e("#iwpage").val(),postData[IWAjax.idfield]=e("#"+IWAjax.idfield).val(),i.find("select,textarea,input[type=text],input[type=checkbox]:checked,input[type=hidden]").each(function(){fieldID=e(this).prop("id"),fieldID.indexOf("_post_types")>0?postData["intelliwidget_"+pre+"_post_types"].push(e(this).val()):postData[fieldID]=e(this).val(),fieldID.indexOf("_menu_location")>0&&""!=e(this).val()&&(postData["intelliwidget_"+pre+"_replace_widget"]="nav_menu_location-"+e(this).val())}),postData.action="iw_"+IWAjax.objtype+"_save",e.post(IWAjax.ajaxurl,postData,function(t){if("fail"==t)savecontainer.addClass("failure");else{var a=e(t.tab),n=e(".iw-tabs").find("#"+a.prop("id"));n.html(a.html()),i.html(t.form),"post"==IWAjax.objtype&&r(i),s.tabs("refresh").tabs({active:n.index()}),i.find(".iw-save-container").addClass("success")}return savebutton.prop("disabled",!1),e(".intelliwidget_"+pre+"_spinner").hide(),IWAjax.ajaxSemaphore=!1,!1},"json").fail(function(){return savebutton.prop("disabled",!1),e(".intelliwidget_"+pre+"_spinner").hide(),savecontainer.addClass("failure"),IWAjax.ajaxSemaphore=!1,!1}),IWAjax.ajaxSemaphore=!1,!1},h=function(){e(this).prop("disabled",!0),e(".iw-copy-container,.iw-save-container,.iw-cdf-container").removeClass("success failure"),e("body").off("click","#iw_copy",h),e("#intelliwidget_spinner").show();var t={};return t.iwpage=e("#iwpage").val(),t[IWAjax.idfield]=e("#"+IWAjax.idfield).val(),t.intelliwidget_widget_page_id=e("#intelliwidget_widget_page_id").val(),t.action="iw_"+IWAjax.objtype+"_copy",e.post(IWAjax.ajaxurl,t,function(t){return e("#iw_copy").prop("disabled",!1),e("#intelliwidget_spinner").hide(),e(".iw-copy-container").addClass("success"),IWAjax.ajaxSemaphore=!1,!1}).fail(function(){return e("#iw_copy").prop("disabled",!1),e("#intelliwidget_spinner").hide(),e(".iw-copy-container").addClass("failure"),IWAjax.ajaxSemaphore=!1,!1}),IWAjax.ajaxSemaphore=!1,!1},f=function(t){if(!0===IWAjax.ajaxSemaphore)return!1;if(IWAjax.ajaxSemaphore=!0,t.preventDefault(),t.stopPropagation(),e(this).hasClass("disabled"))return!1;e(this).addClass("disabled",!0),e(".iw-copy-container,.iw-save-container,.iw-cdf-container").removeClass("success failure");var i=e(this).parent(".inside").find(".iw-tabbed-sections"),a=(i.prop("id"),e(this)),n=e(this).attr("href"),l=b(n);return e("#intelliwidget_spinner").show(),l.action="iw_"+IWAjax.objtype+"_add",e.post(IWAjax.ajaxurl,l,function(t){return a.removeClass("disabled"),e("#intelliwidget_spinner").hide(),"fail"==t?e(".iw-copy-container").addClass("failure"):(form=e(t.form).hide(),tab=e(t.tab).hide(),i.append(form),"post"==IWAjax.objtype&&r(form),i.find(".iw-tabs").append(tab),tab.show(),i.tabs("refresh").tabs({active:tab.index()}),s(),e(".iw-copy-container").addClass("success")),IWAjax.ajaxSemaphore=!1,!1},"json").fail(function(){return a.removeClass("disabled"),e("#intelliwidget_spinner").hide(),e(".iw-copy-container").addClass("failure"),IWAjax.ajaxSemaphore=!1,!1}),IWAjax.ajaxSemaphore=!1,!1},u=function(t){if(!0===IWAjax.ajaxSemaphore)return!1;if(IWAjax.ajaxSemaphore=!0,t.preventDefault(),t.stopPropagation(),e(this).hasClass("disabled"))return!1;e(this).addClass("disabled"),e(".iw-copy-container,.iw-save-container,.iw-cdf-container").removeClass("success failure");var i=e(this),a=i.parents(".iw-tabbed-section").first(),n=a.parent(".iw-tabbed-sections"),l=a.prop("id"),o=a.find(".iw-save-container"),r=c(l),d=e(this).attr("href"),p=b(d);return e(".intelliwidget_"+r+"_spinner").show(),p.action="iw_"+IWAjax.objtype+"_delete",e.post(IWAjax.ajaxurl,p,function(t){if(i.removeClass("disabled"),e(".intelliwidget_"+r+"_spinner").hide(),"success"==t){var l=a.index();a.remove(),e("#iw_tab_"+r).remove(),n.tabs("refresh"),s(),n.tabs({active:l})}else o.addClass("failure");return IWAjax.ajaxSemaphore=!1,!1}).fail(function(){return i.removeClass("disabled"),e(".intelliwidget_"+r+"_spinner").hide(),o.addClass("failure"),IWAjax.ajaxSemaphore=!1,!1}),IWAjax.ajaxSemaphore=!1,!1},v=function(){e(".iw-copy-container,.iw-save-container,.iw-cdf-container").removeClass("success failure");var t=e(this).parents(".iw-tabbed-section").first(),i=t.prop("id"),s=c(i),a=t.find("#intelliwidget_"+s+"_menus"),n=t.find(".iw-save-container"),l=t.find(".iw-save"),o={};return a.has("select").length?!1:(e(l).prop("disabled",!0),e(".intelliwidget_"+s+"_spinner").show(),o.iwpage=e("#iwpage").val(),o[IWAjax.idfield]=e("#"+IWAjax.idfield).val(),o.action="iw_"+IWAjax.objtype+"_menus",t.find('input[type="hidden"]').each(function(t,i){fieldID=e(this).attr("id"),o[fieldID]=e(this).val()}),e.post(IWAjax.ajaxurl,o,function(i){return"fail"==i?n.addClass("failure"):(a.html(i),t.find(".iw-save-container").addClass("success")),l.prop("disabled",!1),e(".intelliwidget_"+s+"_spinner").hide(),!1}).fail(function(){return l.prop("disabled",!1),e(".intelliwidget_"+s+"_spinner").hide(),n.addClass("failure"),!1}),!1)},m=function(){var t=e(this).parents(".widget").first(),i=t.find(".widget-id").val(),s=e("#_wpnonce_widgets").val(),a="widget-"+i,n=t.find("#"+a+"-menus"),l={};return n.has("select").length?!1:(l["widget-id"]=i,l._wpnonce_widgets=s,l.action="iw_widget_menus",e.post(IWAjax.ajaxurl,l,function(e){return"fail"==e||n.html(e),!1}).fail(function(){return!1}),!1)},b=function(e){var t,i,s={},a=e.substring(e.indexOf("?")+1).split("&");for(i=0;i<a.length;i++)t=a[i].split("="),s[decodeURIComponent(t[0])]=decodeURIComponent(t[1]);return s},g=function(t,i){var s,a="#"+t+"_div",n=!i&&!e("#"+t).val(),l=e("#"+t+"_aa").val(),o=("00"+e("#"+t+"_mm").val()).slice(-2),r=("00"+e("#"+t+"_jj").val()).slice(-2),d=("00"+e("#"+t+"_hh").val()).slice(-2),c=("00"+e("#"+t+"_mn").val()).slice(-2),p=e("#"+t+"_og").val();if(!e(a).length)return!0;if(s=new Date(l,o-1,r,d,c),s.getFullYear()!=l||1+s.getMonth()!=o||s.getDate()!=r||s.getMinutes()!=c){if(1==i&&!p)return e(a).addClass("form-invalid"),e(".iw-cdfsave").prop("disabled",!0),!1;n=!0}if(e(a).removeClass("form-invalid"),e(".iw-cdfsave").prop("disabled",!1),n)p||e("#"+t+"_timestamp").html(""),e("#"+t).val("");else{if("intelliwidget_expire_date"==t&&(e("#intelliwidget_ongoing").val(e("#"+t+"_og").is(":checked")?1:0),e("#"+t+"_og").is(":checked")))return e("#"+t+"_timestamp").html(e("#intelliwidget_ongoing_label").text()),e("#"+t).val(""),!0;e("#"+t+"_timestamp").html("<b>"+e('option[value="'+e("#"+t+"_mm").val()+'"]',"#"+t+"_mm").text()+" "+r+", "+l+" @ "+d+":"+c+"</b> "),e("#"+t).val(l+"-"+e("#"+t+"_mm").val()+"-"+r+" "+d+":"+c)}return!0};e(document).ajaxComplete(i),e(".iw-tabbed-sections").tabs({active:e("iw-tab").length-1}),"post"!=IWAjax.objtype&&e("body").on("click",".iw-collapsible > .handlediv, .iw-collapsible > h4, .iw-collapsible > h3",function(i){i.stopPropagation();var s=e(this).parent(".postbox"),a=e(this).parents("div.widget, div.iw-tabbed-section").first();s.toggleClass("closed"),t(a)}),e("body").on("click",".iw-tabbed-sections .panel-selection h3, .iw-tabbed-sections .panel-selection .handlediv",v),e("body").on("click",".widget-inside .panel-selection h4, .widget-inside .panel-selection .handlediv",m),e("body").on("click",".iw-save",p),e("body").on("click",".iw-cdfsave",d),e("body").on("click",".iw-copy",h),e("body").on("click",".iw-add",f),e("body").on("click",".iw-delete",u),e("body").on("change",".iw-control",p),e("body").on("change",".iw-widget-control",function(i){var s=e(this).parents("div.widget").first();t(s),wpWidgets.save(s,0,0,0)}),g("intelliwidget_event_date",!1),g("intelliwidget_expire_date",!1),e("body").on("click","a.intelliwidget-edit-timestamp",function(){var t=e(this).attr("id").split("-",1);return e("#"+t+"_div").is(":hidden")&&(e("#"+t+"_div").slideDown("fast"),e("#"+t+"_mm").focus(),e(this).hide()),!1}),e("body").on("click",".intelliwidget-clear-timestamp",function(){var t=e(this).attr("id").split("-",1);return e("#"+t+"_div").slideUp("fast"),e("#"+t+"_mm").val(e("#"+t+"_cur_mm").val()),e("#"+t+"_jj").val(e("#"+t+"_cur_jj").val()),e("#"+t+"_aa").val(e("#"+t+"_cur_aa").val()),e("#"+t+"_hh").val(e("#"+t+"_cur_hh").val()),e("#"+t+"_mn").val(e("#"+t+"_cur_mn").val()),e("#"+t+"_og").prop("checked",!1),e("#"+t+"_timestamp").html(""),e("#"+t).val(""),e("a#"+t+"-edit").show(),g(t,!1),!1}),e("body").on("click",".intelliwidget-cancel-timestamp",function(){var t=e(this).attr("id").split("-",1);return e("#"+t+"_div").slideUp("fast"),e("#"+t+"_mm").val(e("#"+t+"_hidden_mm").val()),e("#"+t+"_jj").val(e("#"+t+"_hidden_jj").val()),e("#"+t+"_aa").val(e("#"+t+"_hidden_aa").val()),e("#"+t+"_hh").val(e("#"+t+"_hidden_hh").val()),e("#"+t+"_mn").val(e("#"+t+"_hidden_mn").val()),e("#"+t+"_og").prop("checked",e("#"+t+"_hidden_og").val()?!0:!1),e("a#"+t+"-edit").show(),g(t,!1),!1}),e("body").on("click",".intelliwidget-save-timestamp",function(){var t=e(this).attr("id").split("-",1);return g(t,!0)&&(e("#"+t+"_div").slideUp("fast"),e("a#"+t+"-edit").show()),!1}),e(".iw-tabbed-sections").on("click",".iw-larr, .iw-rarr",function(t){t.preventDefault(),t.stopPropagation(),e(this).is(":visible")&&(e(this).hasClass("iw-larr")?n(e(this)):l(e(this)))}),e(window).resize(a),e(".iw-tabbed-sections").slideDown(),s()}),function(e,t,i,s){e.fn.quicksearch=function(i,s){var a,n,l,o,r="",d=this,c=e.extend({delay:100,selector:null,stripeRows:null,loader:null,noResults:"",matchedResultsCount:0,bind:"keyup",onBefore:function(){},onAfter:function(){},show:function(){this.style.display=""},hide:function(){this.style.display="none"},prepareQuery:function(e){return e.toLowerCase().split(" ")},testQuery:function(e,t,i){for(var s=0;s<e.length;s+=1)if(-1===t.indexOf(e[s]))return!1;return!0}},s);return this.go=function(){for(var e=0,t=0,i=!0,s=c.prepareQuery(r),a=0===r.replace(" ","").length,e=0,o=l.length;o>e;e++)a||c.testQuery(s,n[e],l[e])?(c.show.apply(l[e]),i=!1,t++):c.hide.apply(l[e]);return i?this.results(!1):(this.results(!0),this.stripe()),this.matchedResultsCount=t,this.loader(!1),c.onAfter(),this},this.search=function(e){r=e,d.trigger()},this.currentMatchedResults=function(){return this.matchedResultsCount},this.stripe=function(){if("object"==typeof c.stripeRows&&null!==c.stripeRows){var t=c.stripeRows.join(" "),i=c.stripeRows.length;o.not(":hidden").each(function(s){e(this).removeClass(t).addClass(c.stripeRows[s%i])})}return this},this.strip_html=function(t){var i=t.replace(new RegExp("<[^<]+>","g"),"");return i=e.trim(i.toLowerCase())},this.results=function(t){return"string"==typeof c.noResults&&""!==c.noResults&&(t?e(c.noResults).hide():e(c.noResults).show()),this},this.loader=function(t){return"string"==typeof c.loader&&""!==c.loader&&(t?e(c.loader).show():e(c.loader).hide()),this},this.cache=function(){o=e(i),"string"==typeof c.noResults&&""!==c.noResults&&(o=o.not(c.noResults));var t="string"==typeof c.selector?o.find(c.selector):e(i).not(c.noResults);return n=t.map(function(){return d.strip_html(this.innerHTML)}),l=o.map(function(){return this}),r=r||this.val()||"",this.go()},this.trigger=function(){return this.loader(!0),c.onBefore(),t.clearTimeout(a),a=t.setTimeout(function(){d.go()},c.delay),this},this.cache(),this.results(!0),this.stripe(),this.loader(!1),this.each(function(){e(this).on(c.bind,function(){r=e(this).val(),d.trigger()})})}}(jQuery,this,document),!function(e){"use strict";var t=function(t,i){this.options=i,this.$element=e(t),this.$container=e("<div/>",{"class":"ms-container"}),this.$selectableContainer=e("<div/>",{"class":"ms-selectable"}),this.$selectionContainer=e("<div/>",{"class":"ms-selection"}),this.$selectableUl=e("<ul/>",{"class":"ms-list",tabindex:"-1"}),this.$selectionUl=e("<ul/>",{"class":"ms-list",tabindex:"-1"}),this.scrollTo=0,this.elemsSelector="li:visible:not(.ms-optgroup-label,.ms-optgroup-container,."+i.disabledClass+")"};t.prototype={constructor:t,init:function(){var t=this,i=this.$element;if(0===i.next(".ms-container").length){i.css({position:"absolute",left:"-9999px"}),i.attr("id",i.attr("id")?i.attr("id"):Math.ceil(1e3*Math.random())+"multiselect"),this.$container.attr("id","ms-"+i.attr("id")),this.$container.addClass(t.options.cssClass),i.find("option").each(function(){t.generateLisFromOption(this)}),this.$selectionUl.find(".ms-optgroup-label").hide(),t.options.selectableHeader&&t.$selectableContainer.append(t.options.selectableHeader),t.$selectableContainer.append(t.$selectableUl),t.options.selectableFooter&&t.$selectableContainer.append(t.options.selectableFooter),t.options.selectionHeader&&t.$selectionContainer.append(t.options.selectionHeader),t.$selectionContainer.append(t.$selectionUl),t.options.selectionFooter&&t.$selectionContainer.append(t.options.selectionFooter),t.$container.append(t.$selectableContainer),t.$container.append(t.$selectionContainer),i.after(t.$container),t.activeMouse(t.$selectableUl),t.activeKeyboard(t.$selectableUl);var s=t.options.dblClick?"dblclick":"click";t.$selectableUl.on(s,".ms-elem-selectable",function(){t.select(e(this).data("ms-value"))}),t.$selectionUl.on(s,".ms-elem-selection",function(){t.deselect(e(this).data("ms-value"))}),t.activeMouse(t.$selectionUl),t.activeKeyboard(t.$selectionUl),i.on("focus",function(){t.$selectableUl.focus()})}var a=i.find("option:selected").map(function(){return e(this).val()}).get();t.select(a,"init"),"function"==typeof t.options.afterInit&&t.options.afterInit.call(this,this.$container)},generateLisFromOption:function(t,i,s){for(var a=this,n=a.$element,l="",o=e(t),r=0;r<t.attributes.length;r++){var d=t.attributes[r];"value"!==d.name&&"disabled"!==d.name&&(l+=d.name+'="'+d.value+'" ')}var c=e("<li "+l+"><span>"+a.escapeHTML(o.text())+"</span></li>"),p=c.clone(),h=o.val(),f=a.sanitize(h);c.data("ms-value",h).addClass("ms-elem-selectable").attr("id",f+"-selectable"),p.data("ms-value",h).addClass("ms-elem-selection").attr("id",f+"-selection").hide(),(o.prop("disabled")||n.prop("disabled"))&&(p.addClass(a.options.disabledClass),c.addClass(a.options.disabledClass));var u=o.parent("optgroup");if(u.length>0){var v=u.attr("label"),m=a.sanitize(v),b=a.$selectableUl.find("#optgroup-selectable-"+m),g=a.$selectionUl.find("#optgroup-selection-"+m);if(0===b.length){var w='<li class="ms-optgroup-container"></li>',_='<ul class="ms-optgroup"><li class="ms-optgroup-label"><span>'+v+"</span></li></ul>";b=e(w),g=e(w),b.attr("id","optgroup-selectable-"+m),g.attr("id","optgroup-selection-"+m),b.append(e(_)),g.append(e(_)),a.options.selectableOptgroup&&(b.find(".ms-optgroup-label").on("click",function(){var t=u.children(":not(:selected, :disabled)").map(function(){return e(this).val()}).get();a.select(t)}),g.find(".ms-optgroup-label").on("click",function(){var t=u.children(":selected:not(:disabled)").map(function(){return e(this).val()}).get();a.deselect(t)})),a.$selectableUl.append(b),a.$selectionUl.append(g)}i=void 0==i?b.find("ul").children().length:i+1,c.insertAt(i,b.children()),p.insertAt(i,g.children())}else i=void 0==i?a.$selectableUl.children().length:i,c.insertAt(i,a.$selectableUl),p.insertAt(i,a.$selectionUl)},addOption:function(t){var i=this;void 0!==t.value&&null!==t.value&&(t=[t]),e.each(t,function(t,s){if(void 0!==s.value&&null!==s.value&&0===i.$element.find("option[value='"+s.value+"']").length){var a=e('<option value="'+s.value+'">'+s.text+"</option>"),t=parseInt("undefined"==typeof s.index?i.$element.children().length:s.index),n=void 0==s.nested?i.$element:e("optgroup[label='"+s.nested+"']");a.insertAt(t,n),i.generateLisFromOption(a.get(0),t,s.nested)}})},escapeHTML:function(t){return e("<div>").text(t).html()},activeKeyboard:function(t){var i=this;t.on("focus",function(){e(this).addClass("ms-focus")}).on("blur",function(){e(this).removeClass("ms-focus")}).on("keydown",function(s){switch(s.which){case 40:case 38:return s.preventDefault(),s.stopPropagation(),void i.moveHighlight(e(this),38===s.which?-1:1);case 37:case 39:return s.preventDefault(),s.stopPropagation(),void i.switchList(t);case 9:if(i.$element.is("[tabindex]")){s.preventDefault();var a=parseInt(i.$element.attr("tabindex"),10);return a=s.shiftKey?a-1:a+1,void e('[tabindex="'+a+'"]').focus()}s.shiftKey&&i.$element.trigger("focus")}return e.inArray(s.which,i.options.keySelect)>-1?(s.preventDefault(),s.stopPropagation(),void i.selectHighlighted(t)):void 0})},moveHighlight:function(e,t){{var i=e.find(this.elemsSelector),s=i.filter(".ms-hover"),a=null,n=i.first().outerHeight(),l=e.height();"#"+this.$container.prop("id")}if(i.removeClass("ms-hover"),1===t){if(a=s.nextAll(this.elemsSelector).first(),0===a.length){var o=s.parent();if(o.hasClass("ms-optgroup")){var r=o.parent(),d=r.next(":visible");a=d.length>0?d.find(this.elemsSelector).first():i.first()}else a=i.first()}}else if(-1===t&&(a=s.prevAll(this.elemsSelector).first(),0===a.length)){var o=s.parent();if(o.hasClass("ms-optgroup")){var r=o.parent(),c=r.prev(":visible");a=c.length>0?c.find(this.elemsSelector).last():i.last()}else a=i.last()}if(a.length>0){a.addClass("ms-hover");var p=e.scrollTop()+a.position().top-l/2+n/2;e.scrollTop(p)}},selectHighlighted:function(e){var t=e.find(this.elemsSelector),i=t.filter(".ms-hover").first();i.length>0&&(e.parent().hasClass("ms-selectable")?this.select(i.data("ms-value")):this.deselect(i.data("ms-value")),t.removeClass("ms-hover"))},switchList:function(e){e.blur(),this.$container.find(this.elemsSelector).removeClass("ms-hover"),e.parent().hasClass("ms-selectable")?this.$selectionUl.focus():this.$selectableUl.focus()},activeMouse:function(t){var i=this;e("body").on("mouseenter",i.elemsSelector,function(){e(this).parents(".ms-container").find(i.elemsSelector).removeClass("ms-hover"),e(this).addClass("ms-hover")}),e("body").on("mouseleave",i.elemsSelector,function(){e(this).parents(".ms-container").find(i.elemsSelector).removeClass("ms-hover")})},refresh:function(){this.destroy(),this.$element.multiSelect(this.options)},destroy:function(){e("#ms-"+this.$element.attr("id")).remove(),this.$element.css("position","").css("left",""),this.$element.removeData("multiselect")},select:function(t,i){"string"==typeof t&&(t=[t]);var s=this,a=this.$element,n=e.map(t,function(e){return s.sanitize(e)}),l=this.$selectableUl.find("#"+n.join("-selectable, #")+"-selectable").filter(":not(."+s.options.disabledClass+")"),o=this.$selectionUl.find("#"+n.join("-selection, #")+"-selection").filter(":not(."+s.options.disabledClass+")"),r=a.find("option:not(:disabled)").filter(function(){return e.inArray(this.value,t)>-1});if("init"===i&&(l=this.$selectableUl.find("#"+n.join("-selectable, #")+"-selectable"),o=this.$selectionUl.find("#"+n.join("-selection, #")+"-selection")),l.length>0){l.addClass("ms-selected").hide(),o.addClass("ms-selected").show(),r.prop("selected",!0),s.$container.find(s.elemsSelector).removeClass("ms-hover");var d=s.$selectableUl.children(".ms-optgroup-container");if(d.length>0){d.each(function(){var t=e(this).find(".ms-elem-selectable");t.length===t.filter(".ms-selected").length&&e(this).find(".ms-optgroup-label").hide()});var c=s.$selectionUl.children(".ms-optgroup-container");c.each(function(){var t=e(this).find(".ms-elem-selection");t.filter(".ms-selected").length>0&&e(this).find(".ms-optgroup-label").show()})}else if(s.options.keepOrder&&"init"!==i){var p=s.$selectionUl.find(".ms-selected");p.length>1&&p.last().get(0)!=o.get(0)&&o.insertAfter(p.last())}"init"!==i&&(a.trigger("change"),"function"==typeof s.options.afterSelect&&s.options.afterSelect.call(this,t))}},deselect:function(t){"string"==typeof t&&(t=[t]);var i=this,s=this.$element,a=e.map(t,function(e){return i.sanitize(e)}),n=this.$selectableUl.find("#"+a.join("-selectable, #")+"-selectable"),l=this.$selectionUl.find("#"+a.join("-selection, #")+"-selection").filter(".ms-selected").filter(":not(."+i.options.disabledClass+")"),o=s.find("option").filter(function(){return e.inArray(this.value,t)>-1});if(l.length>0){n.removeClass("ms-selected").show(),l.removeClass("ms-selected").hide(),o.prop("selected",!1),i.$container.find(i.elemsSelector).removeClass("ms-hover");var r=i.$selectableUl.children(".ms-optgroup-container");if(r.length>0){r.each(function(){var t=e(this).find(".ms-elem-selectable");t.filter(":not(.ms-selected)").length>0&&e(this).find(".ms-optgroup-label").show()});var d=i.$selectionUl.children(".ms-optgroup-container");d.each(function(){var t=e(this).find(".ms-elem-selection");0===t.filter(".ms-selected").length&&e(this).find(".ms-optgroup-label").hide()})}s.trigger("change"),"function"==typeof i.options.afterDeselect&&i.options.afterDeselect.call(this,t)}},select_all:function(){var t=this.$element,i=t.val();if(t.find('option:not(":disabled")').prop("selected",!0),this.$selectableUl.find(".ms-elem-selectable").filter(":not(."+this.options.disabledClass+")").addClass("ms-selected").hide(),this.$selectionUl.find(".ms-optgroup-label").show(),this.$selectableUl.find(".ms-optgroup-label").hide(),this.$selectionUl.find(".ms-elem-selection").filter(":not(."+this.options.disabledClass+")").addClass("ms-selected").show(),this.$selectionUl.focus(),t.trigger("change"),"function"==typeof this.options.afterSelect){var s=e.grep(t.val(),function(t){return e.inArray(t,i)<0});this.options.afterSelect.call(this,s)}},deselect_all:function(){var e=this.$element,t=e.val();e.find("option").prop("selected",!1),this.$selectableUl.find(".ms-elem-selectable").removeClass("ms-selected").show(),this.$selectionUl.find(".ms-optgroup-label").hide(),this.$selectableUl.find(".ms-optgroup-label").show(),this.$selectionUl.find(".ms-elem-selection").removeClass("ms-selected").hide(),this.$selectableUl.focus(),e.trigger("change"),"function"==typeof this.options.afterDeselect&&this.options.afterDeselect.call(this,t)},sanitize:function(e){var t,i,s=0;if(0==e.length)return s;var a=0;for(t=0,a=e.length;a>t;t++)i=e.charCodeAt(t),s=(s<<5)-s+i,s|=0;return s}},e.fn.multiSelect=function(){var i=arguments[0],s=arguments;return this.each(function(){var a=e(this),n=a.data("multiselect"),l=e.extend({},e.fn.multiSelect.defaults,a.data(),"object"==typeof i&&i);n||a.data("multiselect",n=new t(this,l)),"string"==typeof i?n[i](s[1]):n.init()})},e.fn.multiSelect.defaults={keySelect:[32],selectableOptgroup:!1,disabledClass:"disabled",dblClick:!1,keepOrder:!1,cssClass:""},e.fn.multiSelect.Constructor=t,e.fn.insertAt=function(e,t){return this.each(function(){0===e?t.prepend(this):t.children().eq(e-1).after(this)})}}(window.jQuery);